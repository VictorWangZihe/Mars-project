test_check("mars")
library(mars)
#' @param control an object of class 'mars.control'
#' @param ... the generic parameter
#'
#' @return an object of class 'mars
#' @export
#'
#' @examples
#'  mm <- mars(wage ~ age,data=ISLR::Wage)
#' @import stats
#' @import ISLR
mars <- function(formula, data, control = NULL,...){
if (is.null(control) || missing(control)) {
control <- mars.control()
}
cc <- match.call() # save the call
mf <- model.frame(formula,data)
plotnames = colnames(mf)
y <- model.response(mf)
mt <- attr(mf, "terms")
x <- model.matrix(mt, mf)[,-1, drop = FALSE]
x_names = colnames(x)
fwd <- fwd_stepwise(y, x, control)
bwd <- bwd_stepwise(fwd, control)
model = lm(y ~.-1, data.frame(y = y, bwd$B))
out = c(list(call = cc, formula = formula, y=y, B=bwd$B, Bfuncs = bwd$Bfuncs, x_names = x_names),
model)
class(out) = c("mars", class(model))
return(out)
}
